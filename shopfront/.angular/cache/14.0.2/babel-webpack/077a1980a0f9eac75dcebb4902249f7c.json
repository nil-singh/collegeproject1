{"ast":null,"code":"function _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nimport dropEmptyRows from './dropEmptyRows.js';\nimport dropEmptyColumns from './dropEmptyColumns.js';\nexport default function getData(sheet, options) {\n  var dimensions = sheet.dimensions,\n      cells = sheet.cells; // If the sheet is empty.\n\n  if (cells.length === 0) {\n    return [];\n  }\n\n  var _dimensions = _slicedToArray(dimensions, 2),\n      leftTop = _dimensions[0],\n      rightBottom = _dimensions[1]; // Don't discard empty rows or columns at the start.\n  // https://github.com/catamphetamine/read-excel-file/issues/102\n  // const colsCount = (rightBottom.column - leftTop.column) + 1\n  // const rowsCount = (rightBottom.row - leftTop.row) + 1\n\n\n  var colsCount = rightBottom.column;\n  var rowsCount = rightBottom.row; // Initialize spreadsheet data structure.\n\n  var data = new Array(rowsCount);\n  var i = 0;\n\n  while (i < rowsCount) {\n    data[i] = new Array(colsCount);\n    var j = 0;\n\n    while (j < colsCount) {\n      data[i][j] = null;\n      j++;\n    }\n\n    i++;\n  } // Fill in spreadsheet `data`.\n  // (this code implies that `cells` aren't necessarily sorted by row and column:\n  //  maybe that's not correct, this piece code was initially copy-pasted\n  //  from some other library that used `XPath`)\n\n\n  for (var _iterator = _createForOfIteratorHelperLoose(cells), _step; !(_step = _iterator()).done;) {\n    var cell = _step.value; // Don't discard empty rows or columns at the start.\n    // https://github.com/catamphetamine/read-excel-file/issues/102\n    // const rowIndex = cell.row - leftTop.row\n    // const columnIndex = cell.column - leftTop.column\n\n    var rowIndex = cell.row - 1;\n    var columnIndex = cell.column - 1; // Ignore the data in the cell if it's outside of the spreadsheet's \"dimensions\".\n\n    if (columnIndex < colsCount && rowIndex < rowsCount) {\n      data[rowIndex][columnIndex] = cell.value;\n    }\n  } // Fill in the row map.\n\n\n  var rowMap = options.rowMap;\n\n  if (rowMap) {\n    var _i2 = 0;\n\n    while (_i2 < data.length) {\n      rowMap[_i2] = _i2;\n      _i2++;\n    }\n  } // Drop empty columns or rows.\n\n\n  data = dropEmptyRows(dropEmptyColumns(data, {\n    onlyTrimAtTheEnd: true\n  }), {\n    onlyTrimAtTheEnd: true,\n    rowMap: rowMap\n  }); // Optionally transform data before applying `schema`.\n\n  if (options.transformData) {\n    data = options.transformData(data); // data = options.transformData(data, {\n    //   dropEmptyRowsAndColumns(data) {\n    //     return dropEmptyRows(dropEmptyColumns(data), { rowMap })\n    //   }\n    // })\n  }\n\n  return data;\n}","map":{"version":3,"names":["_createForOfIteratorHelperLoose","o","allowArrayLike","it","Symbol","iterator","call","next","bind","Array","isArray","_unsupportedIterableToArray","length","i","done","value","TypeError","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","minLen","_arrayLikeToArray","n","Object","prototype","toString","slice","constructor","name","from","test","len","arr2","_i","_arr","_n","_d","_s","_e","push","err","dropEmptyRows","dropEmptyColumns","getData","sheet","options","dimensions","cells","_dimensions","leftTop","rightBottom","colsCount","column","rowsCount","row","data","j","_iterator","_step","cell","rowIndex","columnIndex","rowMap","_i2","onlyTrimAtTheEnd","transformData"],"sources":["F:/New folder/shopfront/node_modules/read-excel-file/modules/read/getData.js"],"sourcesContent":["function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport dropEmptyRows from './dropEmptyRows.js';\nimport dropEmptyColumns from './dropEmptyColumns.js';\nexport default function getData(sheet, options) {\n  var dimensions = sheet.dimensions,\n      cells = sheet.cells; // If the sheet is empty.\n\n  if (cells.length === 0) {\n    return [];\n  }\n\n  var _dimensions = _slicedToArray(dimensions, 2),\n      leftTop = _dimensions[0],\n      rightBottom = _dimensions[1]; // Don't discard empty rows or columns at the start.\n  // https://github.com/catamphetamine/read-excel-file/issues/102\n  // const colsCount = (rightBottom.column - leftTop.column) + 1\n  // const rowsCount = (rightBottom.row - leftTop.row) + 1\n\n\n  var colsCount = rightBottom.column;\n  var rowsCount = rightBottom.row; // Initialize spreadsheet data structure.\n\n  var data = new Array(rowsCount);\n  var i = 0;\n\n  while (i < rowsCount) {\n    data[i] = new Array(colsCount);\n    var j = 0;\n\n    while (j < colsCount) {\n      data[i][j] = null;\n      j++;\n    }\n\n    i++;\n  } // Fill in spreadsheet `data`.\n  // (this code implies that `cells` aren't necessarily sorted by row and column:\n  //  maybe that's not correct, this piece code was initially copy-pasted\n  //  from some other library that used `XPath`)\n\n\n  for (var _iterator = _createForOfIteratorHelperLoose(cells), _step; !(_step = _iterator()).done;) {\n    var cell = _step.value;\n    // Don't discard empty rows or columns at the start.\n    // https://github.com/catamphetamine/read-excel-file/issues/102\n    // const rowIndex = cell.row - leftTop.row\n    // const columnIndex = cell.column - leftTop.column\n    var rowIndex = cell.row - 1;\n    var columnIndex = cell.column - 1; // Ignore the data in the cell if it's outside of the spreadsheet's \"dimensions\".\n\n    if (columnIndex < colsCount && rowIndex < rowsCount) {\n      data[rowIndex][columnIndex] = cell.value;\n    }\n  } // Fill in the row map.\n\n\n  var rowMap = options.rowMap;\n\n  if (rowMap) {\n    var _i2 = 0;\n\n    while (_i2 < data.length) {\n      rowMap[_i2] = _i2;\n      _i2++;\n    }\n  } // Drop empty columns or rows.\n\n\n  data = dropEmptyRows(dropEmptyColumns(data, {\n    onlyTrimAtTheEnd: true\n  }), {\n    onlyTrimAtTheEnd: true,\n    rowMap: rowMap\n  }); // Optionally transform data before applying `schema`.\n\n  if (options.transformData) {\n    data = options.transformData(data); // data = options.transformData(data, {\n    //   dropEmptyRowsAndColumns(data) {\n    //     return dropEmptyRows(dropEmptyColumns(data), { rowMap })\n    //   }\n    // })\n  }\n\n  return data;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}